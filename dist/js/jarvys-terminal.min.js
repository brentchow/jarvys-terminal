/*
 *		TERMINAL SIM - jarvys-terminal.min.js
 *		Created by @helloBrent
 *		A JARVYS.io Project
 */

var jarvys=angular.module("jarvys",["luegg.directives"])jarvys.filter("nl2br",["$sce",function(n){return function(t){return t?n.trustAsHtml(t.replace(/\n/g,"<br/>")):""}}])jarvys.directive("ngEnter",function(){return function(n,t,e){t.bind("keydown keypress",function(t){13===t.which&&(n.$apply(function(){n.$eval(e.ngEnter,{event:t})}),t.preventDefault())})}}),jarvys.directive("focusOn",function(){return function(n,t,e){n.$on("focusOn",function(n,u){u===e.focusOn&&t[0].focus()})}})jarvys.factory("focus",function(n,t){return function(e){t(function(){n.$broadcast("focusOn",e)})}}),function(n,t){"use strict";n.module("luegg.directives",[]).directive("scrollGlue",function(n){function e(n){var t=n;return{getValue:function(){return t},setValue:function(n){t=n}}}function u(n,t){return{getValue:function(){return n(t)},setValue:function(){}}}function s(n,t,e){return{getValue:function(){return n(e)},setValue:function(u){u!==n(e)&&e.$apply(function(){t(e,u)})}}}function o(o,r){if(""!==o){var i=n(o);return i.assign!==t?s(i,i.assign,r):u(i,r)}return e(!0)}return{priority:1,restrict:"A",link:function(n,t,e){function u(){p.scrollTop=p.scrollHeight}function s(){a.getValue()&&u()}function r(){return p.scrollTop+p.clientHeight+1>=p.scrollHeight}function i(){a.setValue(r())}var p=t[0],a=o(e.scrollGlue,n);n.$watch(s),t.bind("scroll",i)}}})}(angular)jarvys.controller("TerminalController",["$scope","$timeout","focus",function(n,t,e){n.inputs=[{id:"input1"}],n.responses=["error",'This host has been added successfully to your Jarvys account.\nThe initial backup will start automatically in less than an hour.\nIf you\'d like to backup right now, run the following command:\n\n<span class="terminal-command">jarvys backup</span>',"Backing up...","Oops, try again. We're going to reset your CLI in 3 seconds.","Item(s) to restore: /home/jdoe/project\nSnapshot from x days: 2\nRestore location: /root/jarvys-restore\n\nWARNING: Any files in the restore directory may be overwritten,\nmake sure any files you want to keep are safely moved elsewhere.\n\nContinue with restore? [y/n]","Restoring...",'Backup complete!\n\nTry restoring with this command:\n\n<span class="terminal-command">jarvys restore /home/jdoe/project</span>',"Your file(s)/directory were successfully restored!","Restore cancelled.\n\nTry again. We're going to reset your CLI in 3 seconds."],n.inputCount=n.inputs.length-1,n.addNewInput=function(){var t=n.inputs.length+1,u=n.inputs.length;n.inputs.push({id:"input"+t}),e(n.inputs[u].id)},n.inputResponse2=function(e,u){t(function(){2==u?(n.inputs[e].response2=n.responses[6],n.addNewInput()):5==u&&(n.inputs[e].response2=n.responses[7],n.addNewInput())},2e3)},n.inputResponse=function(t,e){n.inputs[t].response=n.responses[e],n.inputs[t].disabled=!0,n.inputResponse2(t,e),2!==e&&5!==e&&6!==e&&8!==e&&n.addNewInput()},n.restartConsole=function(e,u){n.inputs[e].response=n.responses[u],n.inputs[e].disabled=!0,t(function(){n.inputs=[{id:"input1"}],n.inputCount=n.inputs.length-1},3e3)},n.terminalSubmit=function(){n.inputCount=n.inputs.length-1,0==n.inputCount?'curl -d \'{"k":"myKey"}\' https://my.jarvys.io/setup > jarvys-setup.sh && sh jarvys-setup.sh'==n.inputs[n.inputCount].name?n.inputResponse(n.inputCount,1):n.inputResponse(n.inputCount,0):1==n.inputCount?'curl -d \'{"k":"myKey"}\' https://my.jarvys.io/setup > jarvys-setup.sh && sh jarvys-setup.sh'!==n.inputs[n.inputCount-1].name&&'curl -d \'{"k":"myKey"}\' https://my.jarvys.io/setup > jarvys-setup.sh && sh jarvys-setup.sh'==n.inputs[n.inputCount].name?n.inputResponse(n.inputCount,1):'curl -d \'{"k":"myKey"}\' https://my.jarvys.io/setup > jarvys-setup.sh && sh jarvys-setup.sh'==n.inputs[n.inputCount-1].name&&"jarvys backup"==n.inputs[n.inputCount].name?n.inputResponse(n.inputCount,2):n.restartConsole(n.inputCount,3):2==n.inputCount?'curl -d \'{"k":"myKey"}\' https://my.jarvys.io/setup > jarvys-setup.sh && sh jarvys-setup.sh'==n.inputs[n.inputCount-1].name&&"jarvys backup"==n.inputs[n.inputCount].name?n.inputResponse(n.inputCount,2):"jarvys backup"==n.inputs[n.inputCount-1].name&&"jarvys restore /home/jdoe/project"==n.inputs[n.inputCount].name?n.inputResponse(n.inputCount,4):n.restartConsole(n.inputCount,3):3==n.inputCount?"jarvys restore /home/jdoe/project"==n.inputs[n.inputCount-1].name&&"y"==n.inputs[n.inputCount].name?n.inputResponse(n.inputCount,5):"jarvys restore /home/jdoe/project"==n.inputs[n.inputCount-1].name&&"n"==n.inputs[n.inputCount].name?n.restartConsole(n.inputCount,8):"jarvys backup"==n.inputs[n.inputCount-1].name&&"jarvys restore /home/jdoe/project"==n.inputs[n.inputCount].name?n.inputResponse(n.inputCount,4):n.restartConsole(n.inputCount,3):4==n.inputCount?"jarvys restore /home/jdoe/project"==n.inputs[n.inputCount-1].name&&"y"==n.inputs[n.inputCount].name?n.inputResponse(n.inputCount,5):"jarvys restore /home/jdoe/project"==n.inputs[n.inputCount-1].name&&"n"==n.inputs[n.inputCount].name?n.restartConsole(n.inputCount,8):n.restartConsole(n.inputCount,3):n.restartConsole(n.inputCount,3)}}]);